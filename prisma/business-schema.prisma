// Business Database Schema (MySQL) - READ ONLY
// This file contains models for business data that will be queried
// IMPORTANT: This database is read-only. No write operations are allowed.
// Schema matches existing database structure

generator client {
    provider = "prisma-client-js"
    output   = "../node_modules/.prisma/business-client"
}

datasource db {
    provider = "mysql"
    url      = env("MYSQL_WRITE_DATABASE_URL")
}

// Main business data models - READ ONLY ACCESS
// Schema matches existing database structure
model Gift {
    id                  Int       @id @default(autoincrement())
    ACCOUNTID           String    @db.Text
    GIFTID              String    @db.Text
    GIFTDATE            DateTime? @db.Date
    GIFTAMOUNT          Decimal?  @db.Decimal(15, 2)
    TRANSACTIONTYPE     String?   @db.VarChar(50)
    GIFTTYPE            String?   @db.VarChar(50)
    PAYMENTMETHOD       String?   @db.VarChar(50)
    PLEDGEID            String    @db.Text
    SOFTCREDITINDICATOR String?   @db.VarChar(50)
    SOFTCREDITAMOUNT    Decimal?  @db.Decimal(10, 2)
    SOFTCREDITID        String    @db.Text
    SOURCECODE          String?   @db.VarChar(100)
    DESIGNATION         String?   @db.Text
    UNIT                String?   @db.VarChar(100)
    PURPOSECATEGORY     String?   @db.VarChar(50)
    APPEAL              String?   @db.VarChar(50)
    GIVINGLEVEL         String?   @db.VarChar(50)
    UUID                String    @db.Text

    @@map("gifts")
}

// Application models for saved queries and dashboards (stored in business DB)
model SavedQuery {
    id            Int      @id @default(autoincrement())
    userId        Int      @default(1)
    companyId     Int      @default(1)
    title         String   @db.VarChar(255)
    queryText     String   @db.Text
    sqlText       String   @db.Text
    outputMode    Int      @default(1)
    visualConfig  String?  @db.Text
    panelPosition String?  @db.VarChar(100)
    resultData    String?  @db.LongText // Store query results as JSON
    resultColumns String?  @db.Text // Store column metadata as JSON
    createdAt     DateTime @default(now())
    updatedAt     DateTime @default(now()) @updatedAt

    @@map("saved_queries")
}

model SavedDashboard {
    id              Int      @id @default(autoincrement())
    userId          Int      @default(1)
    companyId       Int      @default(1)
    title           String   @db.VarChar(255)
    quadrants       String   @db.Text // JSON string
    visualizations  String   @db.Text // JSON string
    sVisualizations String   @db.Text // JSON string
    topLeftTitle    String   @default("Sample Title") @db.VarChar(255)
    topRightTitle   String   @default("Sample Title") @db.VarChar(255)
    bottomTitle     String   @default("Sample Title") @db.VarChar(255)
    createdAt       DateTime @default(now())

    @@map("saved_dashboards")
}
